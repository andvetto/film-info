(this["webpackJsonpfilm-info"]=this["webpackJsonpfilm-info"]||[]).push([[0],{40:function(e,t,a){e.exports=a(92)},45:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(36),l=a.n(c),s=(a(45),a(10)),o=a(11),i=a(13),m=a(12),u=a(19),d=a(14),f=a(2),h=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){if(this.props.ricerca.Search){var e=this.props.ricerca.Search;return r.a.createElement(r.a.Fragment,null,e.map((function(e){return r.a.createElement("div",{className:"col-lg-3 col-md-4 col-sm-6 py-2",key:e.imdbID},r.a.createElement("div",{className:"card"},r.a.createElement("img",{src:"N/A"!==e.Poster?e.Poster:"https://via.placeholder.com/300x410",alt:e.Title}),r.a.createElement("div",{className:"card-body text-dark"},r.a.createElement("h5",{className:"card-title"},e.Title),r.a.createElement("p",{className:"card-text"},e.Year),r.a.createElement(f.b,{exact:!0,to:"/detail/".concat(e.imdbID),className:"btn btn-primary"},"Go to detail"))))})))}return"Movie not found!"===this.props.ricerca.Error?r.a.createElement("div",{className:"container-fluid text-center"},r.a.createElement("h3",null,"Il film cercato non \xe8 presente nel nostro database!")):r.a.createElement("div",{className:"container-fluid text-center"},r.a.createElement("h3",null,"Ricerca un film o una serie tv inserendo una parola del titolo"))}}]),t}(r.a.Component),p=a(4),b=a(18),v=a.n(b);var E={API_BACKEND:"http://react-film-search.atwebpages.com/laravel-api",AUTH_URL:"http://react-film-search.atwebpages.com/laravel-api/api/auth/"},g=a(16),N=a.n(g),y=E.AUTH_URL;var k=function(){var e=function(){var e=+localStorage.getItem("token-expires"),t=new Date>e;return t&&(localStorage.removeItem("token-expires"),localStorage.removeItem("auth")),t},t=function(e){var t="";switch(e.status){case 401:t=e.data.error;break;default:t="Error contacting server."}return t},a=function(){var e=n();e&&(N.a.defaults.headers.common.Authorization="Bearer "+e)},n=function(){if(e())return null;var t=JSON.parse(localStorage.getItem("auth"));return t?t.access_token:null};return{getUser:function(){var e=JSON.parse(localStorage.getItem("auth"));return e?e.user:null},login:function(e,a){var n,r,c;return v.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,v.a.awrap(N.a.post(y+"login",{email:e,password:a}));case 3:if(n=l.sent,(r=n.data)&&r.access_token){l.next=7;break}return l.abrupt("return",Promise.reject("Invalid server response"));case 7:return c=(new Date).getTime()+1e3*r.expires_in,localStorage.setItem("token-expires",c),localStorage.setItem("auth",JSON.stringify(n.data)),l.abrupt("return",n.data);case 13:return l.prev=13,l.t0=l.catch(0),l.abrupt("return",Promise.reject(t(l.t0.response)));case 16:case"end":return l.stop()}}),null,null,[[0,13]])},signup:function(e,a,n){var r,c,l;return v.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,v.a.awrap(N.a.post(y+"signup",{email:e,name:a,password:n}));case 3:if(r=s.sent,(c=r.data)&&c.access_token){s.next=7;break}return s.abrupt("return",Promise.rejected("Invalid server response"));case 7:return l=(new Date).getTime()+1e3*c.expires_in,localStorage.setItem("token-expires",l),localStorage.setItem("auth",JSON.stringify(r.data)),s.abrupt("return",r.data);case 13:return s.prev=13,s.t0=s.catch(0),s.abrupt("return",Promise.reject(t(s.t0.response)));case 16:case"end":return s.stop()}}),null,null,[[0,13]])},logout:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return a(),t.prev=1,t.next=4,v.a.awrap(N.a.post(y+"logout"));case 4:return e=t.sent,localStorage.removeItem("auth"),t.abrupt("return",e);case 9:return t.prev=9,t.t0=t.catch(1),t.abrupt("return",t.t0);case 12:case"end":return t.stop()}}),null,null,[[1,9]])},getToken:n,isTokenExpired:e}}(),x=k.getUser(),j=r.a.createContext(x),w=function(e){var t=r.a.useState(),a=Object(p.a)(t,2),n=a[0],c=a[1];return r.a.createElement(j.Provider,{value:[n,c]},e.children)};var O=function(e){var t=r.a.useContext(j),a=Object(p.a)(t,1)[0],n=k.isTokenExpired();return r.a.createElement("nav",{className:"navbar navbar-light bg-dark justify-content-center"},r.a.createElement("input",{className:"form-control col-sm-4 my-2",id:"cerca",onChange:e.onChange,type:"text",value:e.default,placeholder:"Search","aria-label":"Search"}),r.a.createElement("button",{className:"btn btn-block btn-outline-success mx-2",disabled:e.disabled,onClick:e.onClick},"Search"),!a||n?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.b,{exact:!0,to:"/user/login",className:"btn btn-block btn-outline-info mx-2"},"Login"),r.a.createElement(f.b,{exact:!0,to:"/user/signup",className:"btn btn-block btn-outline-info mx-2"},"Signup")):null,a&&!n?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.b,{exact:!0,to:"/favorites/list",className:"btn btn-block btn-outline-warning mx-2"},a.name),r.a.createElement(f.b,{exact:!0,to:"/user/logout",className:"btn btn-block btn-outline-danger mx-2"},"Logout")):null)},S=a(5),I=a(39),C=a.n(I),B=function(e){return Object(S.usePromiseTracker)().promiseInProgress&&r.a.createElement("div",{style:{width:"100%",height:"100",display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement(C.a,{type:"ThreeDots",color:e.color||"#fff",height:100,width:100}))},D=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).state={value:a.props.match.params.titolo||"",disabled:!0},a.handleChange=a.handleChange.bind(Object(u.a)(a)),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.handleClick()}},{key:"handleChange",value:function(e){this.setState({value:e.target.value}),e.target.value.length>2?this.setState({disabled:!1}):e.target.value.length<=2&&this.setState({disabled:!0})}},{key:"handleClick",value:function(){var e=this,t=this.state.value;t===this.state.value&&Object(S.trackPromise)(fetch("https://www.omdbapi.com/?s=".concat(t,"&").concat("apikey=7e18b2af")).then((function(a){return e.setState({response:a,value:t}),a.json()})).then((function(t){e.setState({data:t})}))).catch((function(t){return e.setState({error:t})}))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(O,{onClick:function(){return e.handleClick()},onChange:function(t){return e.handleChange(t)},default:this.state.value,disabled:this.state.disabled}),r.a.createElement("div",{className:"row py-3 justify-content-center",id:"showResults"},r.a.createElement(h,{ricerca:this.state.data||"default",error:this.state.error}),r.a.createElement(B,null)))}}]),t}(r.a.Component),P=a(16),A=E.API_BACKEND,L=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).state={data:"",risultato:[],user:k.getUser(),token:k.getToken(),isTokenExpired:k.isTokenExpired()},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(e){var t=this,a=this.props.match.params.imdbID;Object(S.trackPromise)(fetch("https://www.omdbapi.com/?i=".concat(a,"&").concat("apikey=7e18b2af")).then((function(e){return t.setState({response:e}),e.json()})).then((function(e){return t.setState({ajaxCompleted:!0,data:e}),e})).then((function(e){P.get("".concat(A,"/favorites/").concat(t.state.user.id,"/detail/").concat(e.imdbID)).then((function(e){0!==e.data.length?t.setState({risultato:[e.data[0].title]}):t.setState({risultato:[]})}))}))).catch((function(e){return t.setState({error:e})}))}},{key:"cancella",value:function(){var e=this,t=this.state.data,a=this.state.token;a&&(P.defaults.headers.common.Authorization="Bearer "+a),P.delete("".concat(A,"/favorites/").concat(this.state.user.id,"/delete/").concat(t.imdbID)).then((function(){return e.setState({risultato:[]})}))}},{key:"manda",value:function(){var e=this.state.data,t=this.state.token;t&&(P.defaults.headers.common.Authorization="Bearer "+t),P.post("".concat(A,"/favorites"),{user_id:"".concat(this.state.user.id),title:"".concat(e.Title),year:"".concat(e.Year),plot:"".concat(e.Plot),genre:"".concat(e.Genre),actors:"".concat(e.Actors),director:"".concat(e.Director),runtime:"".concat(e.Runtime),img:"".concat(e.Poster),imdbID:"".concat(e.imdbID)}).then(this.setState({risultato:[1,2]}))}},{key:"findLongestWord",value:function(e){var t=e.split(" "),a="";return t.forEach((function(e){e.length>a.length&&(a=e)})),a}},{key:"render",value:function(){var e,t=this;if(this.state.user&&!this.state.isTokenExpired&&(e=0===this.state.risultato.length?r.a.createElement("i",{className:"fa fa-star stellaBianca",onClick:function(){return t.manda()},"aria-hidden":"true"}):r.a.createElement("i",{className:"fa fa-star stellaGialla",onClick:function(){return t.cancella()},"aria-hidden":"true"})),this.state.data){var a=this.state.data;return r.a.createElement("div",{className:"container text-center border border-secondary py-3"},r.a.createElement("h2",null,a.Title),r.a.createElement("img",{src:"N/A"!==a.Poster?a.Poster:"https://via.placeholder.com/300x410",className:"my-3",alt:a.Title}),r.a.createElement("p",null,a.Plot),r.a.createElement("p",null,"Director: ",a.Director),r.a.createElement("p",null,"Actors: ",a.Actors),r.a.createElement("p",null,"Genre: ",a.Genre),r.a.createElement("p",null,"Runtime: ",a.Runtime),r.a.createElement("p",null,"Year: ",a.Year),r.a.createElement(f.b,{exact:!0,to:"/"+this.findLongestWord(a.Title),className:"btn btn-primary mx-2"},"Go Back"),e)}if(this.state.error){var n=this.state.error;return r.a.createElement("p",null,n)}return r.a.createElement(B,{color:"#007bff"})}}]),t}(r.a.Component);var T=function(){var e=function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return document.getElementById("email")&&(t.test(e)&&(document.getElementById("email").classList.add("is-valid"),document.getElementById("email").classList.remove("is-invalid")),t.test(e)||(document.getElementById("email").classList.add("is-invalid"),document.getElementById("email").classList.remove("is-valid"))),t.test(e)},t=function(e){var t=/^(?=.*?[0-9])(?=.*?[a-zA-Z]).{8,16}$/;return document.getElementById("password")&&(t.test(e)&&(document.getElementById("password").classList.add("is-valid"),document.getElementById("password").classList.remove("is-invalid")),t.test(e)||(document.getElementById("password").classList.add("is-invalid"),document.getElementById("password").classList.remove("is-valid"))),t.test(e)},a=function(e){var t=/^[a-zA-Z0-9]{4,16}$/;return document.getElementById("name")&&(t.test(e)&&(document.getElementById("name").classList.add("is-valid"),document.getElementById("name").classList.remove("is-invalid")),t.test(e)||(document.getElementById("name").classList.add("is-invalid"),document.getElementById("name").classList.remove("is-valid"))),t.test(e)};return{validateSignup:function(n,r,c){return!1!==e(n)&&!1!==t(r)&&!1!==a(c)},validateLogin:function(a,n){return!1!==e(a)&&!1!==t(n)},validateEmail:e,validatePassword:t,validateUsername:a}}(),F=function(e){var t=r.a.useContext(j),a=Object(p.a)(t,2)[1],c=Object(n.useState)(""),l=Object(p.a)(c,2),s=l[0],o=l[1],i=Object(n.useState)(""),m=Object(p.a)(i,2),u=m[0],d=m[1],h=Object(n.useState)(""),b=Object(p.a)(h,2),v=b[0],E=b[1],g=!T.validateLogin(s,u);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:"mb-3"},"Login"),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("form",{className:"form col-sm-6 col-md-4",onSubmit:function(t){t.preventDefault(),Object(S.trackPromise)(k.login(s,u).then((function(t){a(t.user),e.history.push("/favorites/list")})).catch((function(e){E(e)})))}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email",className:"control-label"},"Email"),r.a.createElement("input",{required:!0,name:"email",id:"email",value:s,className:"form-field form-control",onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password",className:"control-label"},"Password"),r.a.createElement("input",{required:!0,name:"password",id:"password",value:u,type:"password",className:"form-field form-control",onChange:function(e){return d(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-success",disabled:g},"Login"),r.a.createElement(f.b,{exact:!0,to:"/",className:"btn btn-primary mx-2 my-2"},"Go Back"),r.a.createElement("button",{className:"btn btn-danger",onClick:function(e){return function(e){e.preventDefault(),o(""),d("")}(e)}},"Reset"))),function(e){return""!==e?r.a.createElement("div",{className:"container-fluid text-center mb-2"},r.a.createElement("h3",{className:"mb-3"},e)):null}(v),r.a.createElement(B,{color:"#2BAD60"})))};function _(e){var t=r.a.useContext(j),a=Object(p.a)(t,2)[1];return r.a.useEffect((function(){Object(S.trackPromise)(k.logout().then((function(){a(null),e.history.push("/")})))})),r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Logging out"),r.a.createElement(B,{color:"#dc3545"}))}var G=function(e){var t=r.a.useContext(j),a=Object(p.a)(t,2)[1],c=Object(n.useState)(""),l=Object(p.a)(c,2),s=l[0],o=l[1],i=Object(n.useState)(""),m=Object(p.a)(i,2),u=m[0],d=m[1],h=Object(n.useState)(""),b=Object(p.a)(h,2),v=b[0],E=b[1],g=Object(n.useState)(""),N=Object(p.a)(g,2),y=N[0],x=N[1],w=!T.validateSignup(s,u,v);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:" mb-3"},"Signup"),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("form",{className:"form col-sm-6 col-md-4",onSubmit:function(t){t.preventDefault(),Object(S.trackPromise)(k.signup(s,v,u).then((function(t){a(t.user),e.history.push("/")})).catch((function(e){x(e)})))}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"name",className:"control-label"},"Username"),r.a.createElement("input",{required:!0,name:"name",id:"name",value:v,className:"form-field form-control",onChange:function(e){return E(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email",className:"control-label"},"Email"),r.a.createElement("input",{required:!0,name:"email",id:"email",value:s,className:"form-field form-control",onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password",className:"control-label"},"Password"),r.a.createElement("input",{required:!0,name:"password",id:"password",type:"password",value:u,className:"form-field form-control",onChange:function(e){return d(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-success",disabled:w},"Signup"),r.a.createElement(f.b,{exact:!0,to:"/",className:"btn btn-primary mx-2 my-2"},"Go Back"),r.a.createElement("button",{className:"btn btn-danger",onClick:function(e){return function(e){e.preventDefault(),o(""),d(""),E("")}(e)}},"Reset"))),function(e){return""!==e?r.a.createElement("div",{className:"container-fluid text-center mb-2"},r.a.createElement("h3",{className:"mb-3"},e)):null}(y),r.a.createElement(B,{color:"#2BAD60"})))},U=function(){return r.a.createElement("footer",null,r.a.createElement("div",{className:"text-center bg-dark py-3 text-secondary"},r.a.createElement("p",null,"\xa9 2019 Copyright")))},R=a(15);a(91);var z=function(e){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement(f.b,{exact:!0,to:"/",className:"btn btn-info my-2"},"Go Back")))},J=a(16),q=E.API_BACKEND,M=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).state={response:"",films:[],user:k.getUser(),token:k.getToken(),isTokenExpired:k.isTokenExpired()},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.token;t&&(J.defaults.headers.common.Authorization="Bearer "+t),this.state.isTokenExpired&&this.props.history.push("/user/login"),Object(S.trackPromise)(J.get("".concat(q,"/favorites/list/").concat(this.state.user.id)).then((function(t){if(t.data!==[])return e.setState({films:t.data});e.setState({films:"error"})})).catch((function(t){return e.setState({error:t})})))}},{key:"render",value:function(){if("no-favorites"!==this.state.films){var e=this.state.films;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container-fluid text-center mb-2"},r.a.createElement("h3",{className:"mb-3"},"I preferiti di ",this.state.user.name),r.a.createElement(z,null)),r.a.createElement(B,{color:"#ffc107"}),r.a.createElement("div",{className:"row justify-content-center"},e.map((function(e){return r.a.createElement("div",{className:"col-lg-3 col-md-4 col-sm-6 py-2",key:e.id},r.a.createElement("div",{className:"card"},r.a.createElement("img",{src:"N/A"!==e.img?e.img:"https://via.placeholder.com/300x410",alt:e.title}),r.a.createElement("div",{className:"card-body text-dark"},r.a.createElement("h5",{className:"card-title"},e.title),r.a.createElement("p",{className:"card-text"},e.year),r.a.createElement(f.b,{exact:!0,to:"/detail/".concat(e.imdbID),className:"btn btn-primary mx-2 my-2"},"Go to detail"))))}))))}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container-fluid text-center mb-2"},r.a.createElement("h3",{className:"mb-3"},"Non hai inserito alcun film tra i preferiti!"),r.a.createElement(z,null)),r.a.createElement(B,{color:"#ffc107"}))}}]),t}(r.a.Component);var W=function(){return console.log(window.location.hostname),r.a.createElement(w,null,r.a.createElement(f.a,null,r.a.createElement("div",{className:"App container-fluid bg-dark text-light text-center"},r.a.createElement("h1",{id:"titolo",className:"py-3"},"Film Information"),r.a.createElement("main",null,r.a.createElement(R.a,{exact:!0,path:"/",component:D}),r.a.createElement(R.a,{exact:!0,path:"/:titolo",component:D}),r.a.createElement(R.a,{exact:!0,path:"/detail/:imdbID",component:L}),r.a.createElement(R.a,{exact:!0,path:"/favorites/list",component:M}),r.a.createElement(R.a,{exact:!0,path:"/user/login",component:F}),r.a.createElement(R.a,{exact:!0,path:"/user/logout",component:_}),r.a.createElement(R.a,{exact:!0,path:"/user/signup",component:G})),r.a.createElement(U,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[40,1,2]]]);
//# sourceMappingURL=main.5405fcfe.chunk.js.map